あなたは熟練したソフトウェアアーキテクトです。以下のコードについて、グレンフォード・マイヤーズの定義する「結合度（Coupling）」と「凝集度（Cohesion）」の観点から厳格なコードレビューを行ってください。

## 依頼事項

1. **結合度の分析**: 現在のコードがどのレベル（内容、共通、制御、スタンプ、データ）に該当するか特定し、より疎結合（データ結合）にするための具体的なリファクタリング案を示してください。特に「制御結合（フラグ引数）」がある場合は指摘してください。
2. **凝集度の分析**: 現在のモジュールがどのレベル（偶発、論理、時間、通信、機能的）に該当するか特定し、より高凝集（機能的凝集）にするための分割案や再設計案を示してください。
3. **具体的なコード修正案**: 上記に基づいた改善後のコード（Before/After）を提示してください。
