---
description: 会話履歴を分析し、CLAUDE.md に追記すべき新しいルールやパターンを提案
see: [これって書くべき？　チームでCLAUDE.mdや.cursor/rulesを育てる](https://zenn.dev/appbrew/articles/7eb12fff5738f4)
---

# CLAUDE.md 更新提案コマンド

**あなたの役割**: 会話履歴を分析し、CLAUDE.md に追記すべき新しいルールやパターンを提案すること。

**重要**: 会話の要約や説明ではなく、「CLAUDE.md に追記する内容の提案」を出力してください。

## 使用方法

```bash
/suggest-claude-md
```

## 分析基準

以下の 3 つのトリガー条件に該当する内容を検出してください。

### 1. プロジェクト独自のルール

**検出パターン**:

- 「〜ではなく〜を使ってください」
- 「このプロジェクトでは〜のようにしています」
- 標準的なコードを生成後、プロジェクト固有の方法に修正指示

**例**:

- 環境変数の直接参照ではなく、プロジェクト独自の Config モジュールを使ってください
- このプロジェクトでは Controller 内で params を直接渡さないルールです
- ORM の標準メソッドではなく、既存の finder メソッドを使ってください

### 2. 同じような修正指示の繰り返し

**検出パターン**:

- 同じ種類の修正指示が 2 回以上出現
- 類似のコード修正が複数ファイルで発生
- 同じアドバイスが複数回行われた

**例**:

- 複数のテストで同じセットアップ処理の追加を指示
- 複数のコントローラーで同じパターンの修正
- 複数のモデルで同じ finder メソッドの使用を指示

### 3. 関連箇所で揃えるべきパターン

**検出パターン**:

- 「こことここは実装を合わせてください」
- 「Web 側と API 側で統一してください」
- 「通常版と WebView 版で揃えてください」
- 関連する複数箇所での統一を指示

**例**:

- 「Web 側が `/brands/:brand_id/series` なら、API 側も `/api/brands/:brand_id/series` にしてください」
- 「`/xxx`を更新したら、`/webview/xxx`も同様に更新してください」
- 「この画像アップロード処理は他のモデルでも同じパターンで実装してください」

## 出力フォーマット

**必須**: 以下のフォーマットで出力してください。他の形式（要約、報告、説明など）は禁止です。

トリガーに引っかかった場合：

```markdown
会話履歴を分析しました。以下の内容を CLAUDE.md に追記しませんか？

追記した方がよさそうであれば、「この内容を CLAUDE.md に追記してください」のように指示してください。

[提案する具体的な内容]

理由: [プロジェクト独自のルール / 同じような修正指示の繰り返し(N 回) / 関連箇所で揃えるべきパターン]
```

トリガーに引っかからなかった場合：

```markdown
会話履歴を分析しました。CLAUDE.md に追記すべき新しい内容は見つかりませんでした。
```

**禁止事項**:

- 「〜を修正しました」「〜を実装しました」などの完了報告形式で書かない
- 会話の要約や説明を出力しない
- 冒頭の「会話履歴を分析しました。」を省略しない

## 提案基準

### 提案する（○）

- プロジェクト全体で共有すべき普遍的なルール
- 技術的な正確性が保証できる内容
- 明確にルール化できる内容
- 今回のコード変更で新しく生まれたパターン

### 提案しない（×）

- 一時的な判断や個別ケースの対応
- 既に CLAUDE.md に記載されている内容
- 個人の好みや一時的な試行
- 不明確または曖昧な指示

## 実行後のアクション

1. 提案内容をレビュー
2. 適切と判断した内容を CLAUDE.md に追記することを Claude に指示
3. コード変更と同じ PR に含める
4. PR レビューでチームメンバーにレビューしてもらう
